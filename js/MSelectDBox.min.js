!function(a){var b=function(a){this.init(a)};b.prototype={instances:[],_coldInit:0,get:function(b,c,d){var e=this;if("string"==typeof b){b=b.toLowerCase(),"undefined"==typeof d&&(d=!0);var f=function(b){d&&e.trigger("get",new a.Event(b))};f("get:"+b);var g={},h={};if("string"==typeof g[b]&&(b=g[b]),"function"==typeof h[b]){if(b=h[b],"function"!=typeof this[b])return;return"undefined"==typeof c&&(c=Object.create(null)),this[b](c)}return"undefined"!=typeof this._props[b]?this._props[b]:void 0}},set:function(b,c,d,e){var f,g=this;if("undefined"==typeof b)return!1;if("object"==typeof b){var h=Object.create(null);for(var i in b)b.hasOwnProperty(i)&&(h[i]=this.set(i,b[i]));return h}if("string"!=typeof b)return!1;b=b.toLowerCase(),"undefined"==typeof e&&(e=!0);var j=function(b){if(e){var d=new a.Event(b);d.value=c,g.trigger("set",d)}};j("set:"+b);var k={},l={};return"string"==typeof k[b]&&(b=k[b]),j("beforeSet:"+b),"string"==typeof l[b]?(b=l[b],"function"!=typeof this[b]?!1:("undefined"==typeof d&&(d=Object.create(null)),f=this[b](c,d),j("afterSet:"+b),f)):(this._props[b]=c,j("afterSet:"+b),!0)},getInstaces:function(){return this.getInstances.apply(this,arguments)},getInstances:function(b){if(!arguments.length)return this.instances;"object"!=typeof b&&(b=Object.create(null));for(var c=a.inArray(typeof b.name,["string","number"])>-1?b.name:null,d=[],e=0;e<this.instances.length;e++)(null===c||this.instances[e].get("name")==c)&&d.push(this.instances[e]);return d},removeInstances:function(b){if("object"==typeof b){for(var c="string"!=typeof b.name?null:b.name,d=[],e=0;e<this.instances.length;e++)this.instances[e].get("name")!=c?d.push(this.instances[e]):a(this.instances[e].get("dbox")).detach();this.instances=d}},_targetEvents:{click:{name:"click",event:"click"},keydown:{name:"keydown",event:"keydown",dbox_input:!0},keyup:{name:"keyup",event:"keyup",dbox_input:!0},hover:{name:"hover",event:"hover"},focus:{name:"focus",event:"focus"},focusout:{name:"focusout",event:"focusout"},change:{name:"change",event:"change"}},_eventCheckInputEmpty:function(a){this.fx.isTextInput(a.target)&&!a.target.value.trim()&&this.trigger("input:empty",a)},_eventDefaultInputEmpty:function(){this.deselectAll()},_eventDefaultSet:function(){this.trigger(arguments[1].type,arguments[1])},_eventDefaultGet:function(){this.trigger(arguments[1].type,arguments[1])},_eventSetList:function(){var a=arguments[1];this.set("list",a.value,null,!1),this.reInitList()},_eventWindowResize:function(){for(var a=0;a<this.instances.length;a++)this.instances[a].isActive()&&(this.instances[a]._calcListContainerHeight(),this.instances[a].calcPosition())},_eventDefaultKeyUp:function(b){var c=this,d=c.get("target"),e=c.get("dbox_input"),f=b.keyCode,g=c.get("list"),h=c.get("dbox"),i=b.currentTarget,j=[37,38,39,40,9,13,18,17,16,20,27];c._isDBoxInput(b.target)?c.fx.isTextInput(d)&&(d.value=e.value):i==d&&-1==j.indexOf(b.keyCode)&&(e.value=d.value),clearTimeout(c._timers.autoComplete),c._timers.autoComplete=setTimeout(function(){var b,d;if(c.get("autoComplete"))if(a.inArray(f,j)>-1);else{var e=a(".m-select-d-box__list-item",h);for(b=i.value.toLowerCase(),b=c.fx.msplit([";",","],b),b=b[b.length-1],d=0;d<e.length;d++){var k=parseInt(e[d].getAttribute("data-msdbid")),l=a(e[d]);b?c._optionFiltersMatcher(c.get("optionFilters"),b,g[k].label)?l.removeClass("m-select-d-box__list-item_hidden"):l.addClass("m-select-d-box__list-item_hidden"):l.removeClass("m-select-d-box__list-item_hidden"),l.removeClass("m-select-d-box__list-item_hover")}c._isMobileState()||c.calcPosition()}if(c.get("multiple")&&8==f){for(b=c.fx.trim(i.value," ;,","both"),b=c.fx.msplit([";",","],b),d=0;d<b.length;d++)b[d]=b[d].trim();for(var m in g)g.hasOwnProperty(m)&&(g[m].selected=a.inArray(g[m].label.trim(),b)>-1);c.applySelectedToList(),c.applySelectedToInput()}},500)},_eventDefaultKeyDownMultipleFalse:function(b){var c,d,e,f,g=this,h=g.get("dbox"),i=g.get("target");if(!g.get("multiple"))if(a.inArray(b.keyCode,[37,39,9,18,17,16,20,27])>-1);else if(13==b.keyCode)g.isActive()?g.close():(g.open(),g._eventFocus.apply(i,[g,b]));else if(a.inArray(b.keyCode,[38,39,40])>-1){if(!g.isActive())return;c=a("ul",h).get(0),d=a("li:not(.m-select-d-box__list-item_hidden)",h);var j,k=-1;for(e=0,f=d.length;f>e;e++)if(j=a(d[e]),j.hasClass("m-select-d-box__list-item_selected")){k=e;break}var l;if(38==b.keyCode)l=0>k-1?0:k-1;else{if(40!=b.keyCode)return 39==b.keyCode,void 0;l=k+1>d.length-1?d.length-1:k+1}var m=parseInt(d[l].getAttribute("data-msdbid"));g._selectByID(m),g._calcScrollBarPosition(),g.trigger("select",b)}},_eventDefaultKeyDownMultipleTrue:function(b){var c,d,e,f=this,g=f.get("dbox");if(f.get("multiple")){if(a.inArray(b.keyCode,[37,39,9,18,17,16,20,27])>-1);else if(13==b.keyCode){var h=a(".m-select-d-box__list-item_hover",g);if(!h.length)return;h=h.get(0);var i=f.getSelectedKeys();e=parseInt(h.getAttribute("data-msdbid"));var j=a.inArray(e,i);return j>-1?i[j]=null:i.push(e),f._selectByID(i),void f.trigger("select",b)}if(a.inArray(b.keyCode,[38,40])>-1){var k=a(".m-select-d-box__list-item:not(.m-select-d-box__list-item_hidden)",g);h=-1;var l;for(c=0,d=k.length;d>c;c++)l=a(k[c]),l.hasClass("m-select-d-box__list-item_hover")&&(h=c);var m;if(38==b.keyCode)m=0>h-1?0:h-1;else{if(40!=b.keyCode)return;m=h+1>k.length-1?k.length-1:h+1}a(k[m]).addClass("m-select-d-box__list-item_hover"),h>-1&&m!=h&&a(k[h]).removeClass("m-select-d-box__list-item_hover"),f._calcScrollBarPosition()}}},_eventFocus:function(b,c){var d,e,f,g=this,h=g.get("list"),i=g.get("dbox");g.open();var j=c.currentTarget||(this instanceof Element?this:null);if(g.fx.isTextInput(j))if(d=j.getAttribute("data-msdb-value"),d&&(d=d.trim()),d){for(d=g.fx.msplit([",",";"],d),e=0;e<d.length;e++)for(d[e]=d[e].trim(),f=0;f<h.length;f++)if(h[f].value==d[e]){h[f].selected=!0;break}}else{var k=g.fx.msplit([",",";"],g.fx.trim(j.value,",; ","both"));for(e=0;e<k.length;e++)for(k[e]=k[e].trim(),f=0;f<h.length;f++)h[f].label==k[e]&&(h[f].selected=!0)}var l=a("li",i);if(l.length)for(l.removeClass("m-select-d-box__list-item_hidden"),f=0;f<l.length;f++)"undefined"!=typeof j.type&&a.inArray(j.type.toLowerCase(),["submit","button"])>-1||a.inArray(j.tagName.toLowerCase(),["submit","body","select"])>-1||a(l[f]).removeClass("m-select-d-box__list-item_hover");g.get("freeWrite")||g.applySelectedToInput(),g.applySelectedToList(),g._calcScrollBarPosition(),g._calcListContainerHeight()},_initEvents:function(b){var c,d=(a("body").get(0),this);this.events=Object.create(null);var e={};for(c in b)b.hasOwnProperty(c)&&"function"==typeof b[c]&&(e[c.replace(/^on/,"")]=b[c]);for(c in b.events)b.events.hasOwnProperty(c)&&"function"==typeof b.events[c]&&(e[c]=b.events[c]);for(c in e)e.hasOwnProperty(c)&&this.on(c,e[c]);this.on("keyup",function(a,b){d._eventCheckInputEmpty(b)}),this.on("change",function(a,b){d._eventCheckInputEmpty(b)}),this.on("input:empty",d._eventDefaultInputEmpty),this.on("focus",d._eventFocus),this.on("click",d._eventFocus),this.on("focusout",function(a,b){return b.relatedTarget?void(d._isDBoxInput(b.relatedTarget)||d._isDBoxElement(b.relatedTarget)||d._isTargetElement(b.relatedTarget)||d.close()):void(d._timers.focusoutInputs=setTimeout(function(){d.close()},250))}),a(this.get("dbox_input")).bind("focus",function(){clearTimeout(d._timers.focusoutInputs)}),this.on("set",this._eventDefaultSet),this.on("get",this._eventDefaultGet),this.on("afterSet:list",this._eventSetList),d._isColdInit()&&window.addEventListener("resize",d._eventWindowResize.bind(d),!1)},_deactivateInstances:function(a){for(var b=0;b<this.instances.length;b++)this.instances[b]._isDBoxElement(a.target)||this.instances[b]._isTargetElement(a.target)||this.instances[b].isActive()&&this.instances[b].close()},_initTarget:function(){var b,c=this.get("target");if(c&&"object"==typeof c)if("string"==typeof c)c=a(c),this.set("target",c.length?c.get(0):null);else if(c instanceof Element)this.set("target",c);else if("object"==typeof c&&"undefined"!=typeof c.push||Array.isArray(c))for(b=0;b<c.length;b++)if(c[b]instanceof Element){this.set("target",c[b]);break}},trigger:function(b,c){if("string"==typeof b&&(b=b.toLowerCase(),"object"==typeof this.events[b]&&Array.isArray(this.events[b]))){c instanceof CustomEvent==0&&c instanceof Event==0&&c instanceof a.Event==0&&(c=a.Event(b));for(var d=this.events[b],e=0;e<d.length;e++)"function"==typeof d[e]&&d[e].apply(this,[this,c])}},on:function(b,c){var d=this,e=this.get("target"),f=this.get("dbox_input");return"string"!=typeof b||"function"!=typeof c?!1:(b=b.toLowerCase(),"object"==typeof this.events[b]&&Array.isArray(this.events[b])||(this.events[b]=[],this._targetEvents.hasOwnProperty(b)&&(a(e).bind(this._targetEvents[b].event,function(a){d.trigger(b,a)},null),this._targetEvents[b].dbox_input&&a(f).bind(this._targetEvents[b].event,function(a){d.trigger(b,a)},null))),this.events[b].push(c),!0)},_detectLanguage:function(){var a=(navigator.languages||[])[0]||navigator.language||navigator.systemLanguage||navigator.userLanguage||navigator.browserLanguage||"en-US";return a.split(/[-_]/gi)[0]},_lastLang:"",_texts:{".m-select-d-box-fade__outside-click-label-text":{ru:"Нажмите чтобы закрыть",en:"Tap to close"},".m-select-d-box__search-input":{ru:"Поиск",en:"Search"}},getText:function(a,b){return!b&&(b=this.get("language")||this._detectLanguage()),(this._texts[a]||{})[b]||""},setText:function(a,c,d){var e=!0,f=this instanceof b?!(e=!1)&&Object.getPrototypeOf(this):this;!f._texts[c]&&(f._texts[c]={}),!d&&(d=!e&&this.get("language")||this._detectLanguage()),f._texts[c][d]=a},_globalElems:{fade:void 0},_globalStyles:{".m-select-d-box":{position:"absolute",display:"block",width:"168px",padding:"8px",height:"auto","box-shadow":"0 0px 8px rgba(0, 0, 0, 0.24)","background-color":"#FFF","border-radius":"3px"},".m-select-d-box:after":{content:"''",position:"absolute","border-left":"10px solid transparent","border-right":"9px solid transparent","border-bottom":"10px solid white",top:"-10px",left:"50%","margin-left":"-10px"},".m-select-d-box_bottom:after":{content:"''",position:"absolute","border-left":"10px solid transparent","border-right":"9px solid transparent","border-bottom":"none","border-top":"10px solid white",top:"auto",bottom:"-10px",left:"50%","margin-left":"-10px"},".m-select-d-box__list-container":{position:"relative",margin:"0px",padding:"0px","max-height":"200px","overflow-x":"hidden"},".m-select-d-box__list-item":{position:"relative",padding:"5px","background-color":"none",color:"black",display:"block","line-height":"100%",cursor:"pointer","font-size":"12px"},".m-select-d-box__list-item:hover, .m-select-d-box__list-item_hover":{"background-color":"#e6e6e6"},".m-select-d-box__list-item_selected":{"background-color":"#C40056",color:"white"},".m-select-d-box__list-item_selected:hover, .m-select-d-box__list-item_selected.m-select-d-box__list-item_hover":{"background-color":"#DB2277"},".m-select-d-box__list-item_selected:before":{content:"':: '"},".m-select-d-box__list-item:active, .m-select-d-box__list-item_selected:active":{"background-color":"#b80000",color:"white"},".m-select-d-box__list-item_hidden":{display:"none"},".m-select-d-box__search-input":{border:"1px solid #a2a2a2",width:"100%","line-height":"100%","font-size":"14px","border-width":"0 0 2px 0",padding:"8px","box-sizing":"border-box"},".m-select-d-box__search-input-container":{"margin-bottom":"12px",display:"none"},".m-select-d-box__search-input-container_active":{display:"block"},".m-select-d-box-fade":{display:"none",width:0,height:0,left:0,top:0},".m-select-d-box-fade__outside-click-label":{position:"absolute",width:"100%",bottom:0,padding:"10px",background:"black",color:"white","text-align":"center","font-size":"1em","box-sizing":"border-box"},".m-select-d-box-fade__outside-click-label-text":{},".m-select-d-box-fade__outside-click-label-icon":{position:"relative","border-radius":"50%","margin-right":"5px",border:"2px solid white",display:"inline-block",height:"16px",width:"16px","vertical-align":"middle"},".m-select-d-box-fade__outside-click-label-icon:after":{content:"''",position:"absolute",top:"50%",left:"50%",height:"80%",width:"2px",transform:"rotate(45deg)","margin-left":"-1px","margin-top":"-40%",background:"white"},".m-select-d-box-fade__outside-click-label-icon:before":{content:"''",position:"absolute",top:"50%",left:"50%",height:"80%",width:"2px",transform:"rotate(-45deg)","margin-left":"-1px","margin-top":"-40%",background:"white"},"@media screen and (max-width: 640px)":{".m-select-d-box":{position:"fixed",width:"80% !important",padding:"0 !important",left:"10% !important",top:"5% !important","max-height":"90%","box-shadow":"none","border-radius":"0px","box-sizing":"border-box"},".m-select-d-box:after":{content:"none"},".m-select-d-box__list-container":{"max-height":"none"},".m-select-d-box__list-item":{padding:"1em","font-size":"1em"},".m-select-d-box__search-input-container":{"margin-bottom":"12px",display:"block"},".m-select-d-box__search-input":{"line-height":"1em","font-size":"1em",padding:"1em"},".m-select-d-box-fade":{width:"100%",height:"100%",position:"fixed",left:0,top:0,"background-color":"rgba(0, 0, 0, 0.33)",display:"block"}},"@media screen and (max-width: 740px)":{"@media screen and (min-resolution: 2dppx)":{}},".m-select-d-box_hidden":{display:"none"}},_initStyles:function(){a("#m-select-d-box-style").length||this._buildStyles()},_buildStyles:function(){this._globalStyles["@media screen and (max-width: 740px)"]["@media screen and (min-resolution: 2dppx)"]=this._globalStyles["@media screen and (max-width: 640px)"];var b=a("body"),c=function(a){var b="";for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d))if(d.match(/^@media/))b+=d+" {"+c(a[d])+"} ";else{b+=d+" {";for(var e in a[d])Object.prototype.hasOwnProperty.call(a[d],e)&&(b+=e+":"+a[d][e]+";");b+="} "}return b},d=c(this._globalStyles),e=a("#m-select-d-box-style");e.length||(e=a("<style />"),e.attr("id","m-select-d-box-style"),b.append(e)),e.html(d)},_initProps:function(b){var c,d,e,f={},g=[{key:"name",type:"string"},{key:"list",type:"array"},{key:"autoApply",type:"any",into:"boolean"},{key:"autoPosition",type:"any",into:"boolean"},{key:"autoComplete",type:"any",into:"boolean"},{key:"target",type:"object"},{key:"multiple",type:"any",into:"boolean"},{key:"zIndex",type:"numeric",into:"integer"},{key:"width",type:"any"},{key:"embeddedInput",type:"any",into:"boolean"},{key:"optionFilters",type:"array"},{key:"closeButton",type:"boolean"},{key:"language",type:"string","default":this._detectLanguage()},{key:"freeWrite",type:"any",into:"boolean"}];for(c=0;c<g.length;c++)g[c].key=g[c].key.toLowerCase(),"default"in g[c]&&(f[g[c].key]=g[c]["default"]);if(this.set(f),"object"==typeof b)for(e in b)if(b.hasOwnProperty(e)){var h=e.toLowerCase(),i=null;for(d=0;d<g.length;d++)if(g[d].key.toLowerCase()==h){i=g[d];break}if(i){if("any"==i.type);else if("array"==i.type){if(!Array.isArray(b[e]))throw new Error("Argument data type mismatch (key: '"+e+"')")}else if("numeric"==i.type){if(isNaN(b[e]))throw new Error("Argument data type mismatch (key: '"+e+"')")}else if(i.type!=typeof b[e])throw new Error("Argument data type mismatch (key: '"+e+"')");i.hasOwnProperty("into")&&("boolean"==i.into?b[e]=Boolean(b[e]):"integer"==i.into?b[e]=parseInt(b[e]):"float"==i.into&&(b[e]=parseFloat(b[e]))),"width"==e&&(b[e]="undefined"==typeof b.width?"min":a.inArray(b.width,["min","auto"])>-1?b.width:parseInt(b.width)),this.set(h,b[e])}}},_initElements:function(){var b=a("body").get(0);this.get("language");this._isColdInit()&&(this._globalElems.fade=a('<div class="m-select-d-box-fade m-select-d-box_hidden"><div class="m-select-d-box-fade__outside-click-label"><div class="m-select-d-box-fade__outside-click-label-icon"></div><span class="m-select-d-box-fade__outside-click-label-text">'+this.getText(".m-select-d-box-fade__outside-click-label-text")+"<span></div></div>").get(0),b.appendChild(this._globalElems.fade));var c=document.createElement("div");this.set("dbox",c),c.className="m-select-d-box m-select-d-box_hidden";var d=a('<div class="m-select-d-box__search-input-container"><input class="m-select-d-box__search-input" placeholder="'+this.getText(".m-select-d-box__search-input")+'" type="text"></div>').get(0);this.set("dbox_input",a("input",d).get(0)),c.appendChild(d),Boolean(this.get("embeddedInput"))&&(d.className+=" m-select-d-box__search-input-container_active"),this.set("dbox",c),this.get("zIndex")&&(c.style.zIndex=this.get("zIndex")),c.appendChild(a('<ul class="m-select-d-box__list-container"></ul>').get(0));var e=this.get("width");"auto"==e?c.style.width=this.get("target").clientWidth+"px":"min"==e||(c.style.width=e+"px"),b.appendChild(c)},_initList:function(){var b,c;if(!a.isArray(this.get("list")))return this.set("list",[],null,!1),!1;var d=this.get("list"),e=this.get("dbox"),f=[];for(b=0,c=d.length;c>b;b++)-1!=a.inArray(typeof d[b],["number","string"])?f.push({value:d[b].toString(),label:d[b].toString(),selected:!1}):"object"==typeof d[b]&&d[b].hasOwnProperty("value")&&d[b].hasOwnProperty("label")&&("undefined"==typeof d[b].selected?d[b].selected=!1:d[b].selected=Boolean(d[b].selected),f.push(d[b]));d=f,this.set("list",f,null,!1);var g=a(".m-select-d-box__list-container",e).get(0);g.innerHTML="";var h=this;for(var i in d)if(d.hasOwnProperty(i)){var j=document.createElement("li");j.className="m-select-d-box__list-item",j.setAttribute("data-msdbid",i),a(j).bind("click",function(a){var b=[];clearTimeout(h._timers.focusoutInputs);var c=parseInt(this.getAttribute("data-msdbid"));h.get("multiple")?(d[c].selected=0==d[c].selected,b=h.getSelectedKeys()):b=[c],h._selectByID(b),h.trigger("select",a),h.calcPosition(),h.get("multiple")||h.close()},null),a(j).bind("mouseleave",function(){var b=a(this);b.hasClass("m-select-d-box__list-item_hover")&&b.removeClass("m-select-d-box__list-item_hover")},null),j.innerHTML=d[i].label,g.appendChild(j)}},init:function(b){this._props=Object.create(null);var c=this,d=a("body").get(0);this.events=Object.create(null),this._initProps(b),this._initTarget(),this._initElements(),this._initEvents(b),this._initList(),this._initStyles(),this._timers=Object.create(null),this._timers.autoComplete=null,this._timers.focusedInputs=null,this._timers.focusoutInputs=null;var e=this.get("target"),f=this.get("dbox");c.get("name")&&(e.setAttribute("data-msdb-name",c.get("name")),f.setAttribute("data-msdb-name",c.get("name"))),c.on("keydown",function(a,b){c._eventDefaultKeyDownMultipleFalse(b),c._eventDefaultKeyDownMultipleTrue(b)}),c.on("keyup",function(a,b){c._eventDefaultKeyUp(b)}),c.get("optionFilters")||c.set("optionFilters",[c.defaultOptionFilters["default"]]),c._isColdInit()&&a(d).bind("click",function(a){c._deactivateInstances(a)},null),this.instances.push(this)},_applyLang:function(b){this._lastLang!=b&&(Object.getPrototypeOf(this)._lastLang=b,a(this._globalElems.fade).find(".m-select-d-box-fade__outside-click-label-text").html(this.getText(".m-select-d-box-fade__outside-click-label-text")))},calcPosition:function(){var b=this,c=a("body").get(0),d=this.get("target",null,null),e=this.get("dbox",null,null),f=a(e),g=a(d).offset(),h=d.clientWidth,i=d.clientHeight,j=e.clientWidth;f.removeClass("m-select-d-box_bottom"),e.style.left=g.left+h/2-(j+2*b._globalStyles[".m-select-d-box"].padding.replace(/[px]/gi,""))/2+"px";var k=window.scrollY||c.scrollTop;e.clientHeight+g.top+i+12-k>window.innerHeight?(e.style.top=g.top-12-e.clientHeight+"px",f.addClass("m-select-d-box_bottom")):e.style.top=g.top+i+12+"px"},_calcScrollBarPosition:function(){var b,c=this.get("dbox"),d=a(".m-select-d-box__list-container",c).get(0);if(b=this.get("multiple")?a(".m-select-d-box__list-item_hover",c):a(".m-select-d-box__list-item_selected",c),b.length){var e=b.position().top+d.scrollTop;return e<d.clientHeight/2?void(d.scrollTop=0):void(d.scrollTop=e-d.clientHeight/2)}},_calcListContainerHeight:function(){var b=a(this.get("dbox")).find(".m-select-d-box__list-container").get(0);if(this._isMobileState()){var c=window.innerHeight/100;return void(b.style.maxHeight=90*c-64-40+"px")}b.style.maxHeight&&(b.style.maxHeight="")},_isDBoxElement:function(b){var c=this.get("dbox",null,null),d=a(c).find("*");if(d){d=Array.prototype.slice.call(d,0),d.push(c);for(var e=0;e<d.length;e++)if(d[e]==b)return!0}return!1},_isTargetElement:function(b){var c=this.get("target",null,null),d=a(c).find("*");if(d){d=Array.prototype.slice.call(d,0),d.push(c);for(var e=0;e<d.length;e++)if(d[e]==b)return!0}return!1},_isDBoxInput:function(a){return this.get("dbox_input")===a},_isMobileState:function(){return window.innerWidth<=640||window.innerWidth<=740&&this.fx.isHDensScreen()},_isBoxBottomState:function(){var a=this.get("dbox",null,null);return Boolean(a.className.match(new RegExp("m-select-d-box_bottom")))},_isColdInit:function(){return!this.instances.length},getSelectedKeys:function(){for(var a=[],b=this.get("list"),c=0;c<b.length;c++)"undefined"!=typeof b[c].selected&&b[c].selected&&a.push(c);return a},getSelectedValues:function(){for(var a=[],b=this.get("list"),c=0;c<b.length;c++)"undefined"!=typeof b[c].selected&&b[c].selected&&a.push(b[c].value);return a},getSelectedLabels:function(){for(var a=[],b=this.get("list"),c=0;c<b.length;c++)"undefined"!=typeof b[c].selected&&b[c].selected&&a.push(b[c].label);return a},hasValue:function(a){for(var b=this.get("list"),c=0;c<b.length;c++)if(b[c].value===a)return!0;return!1},hasLabel:function(a){for(var b=this.get("list"),c=0;c<b.length;c++)if(b[c].label===a)return!0;return!1},applySelectedToList:function(){var b=this.get("dbox"),c=this.get("list"),d=a("li",b);d.removeClass("m-select-d-box__list-item_selected");for(var e=0,f=d.length;f>e;e++){var g=d[e].getAttribute("data-msdbid");"undefined"!=typeof c[g]&&c[g].selected&&a(d[e]).addClass("m-select-d-box__list-item_selected")}},applySelectedToInput:function(){var b=this,c=b.getSelectedValues(),d=b.getSelectedLabels(),e=this.get("target"),f=this.get("dbox_input");f.value=d.join("; ")+(d.length&&this.get("multiple")?";":"");var g=e.tagName.toLowerCase();if("input"==g)b.fx.isTextInput(e)&&(e.value=f.value);else if("textarea"==g)e.value=d.join(";\n")+(d.length&&this.get("multiple")?";\n":"");else if("select"==g)for(var h=0;h<e.options.length;h++)e.options[h].selected=a.inArray(e.options[h].value,c)>-1;e.setAttribute("data-msdb-value",c.join(";")+(c.length&&this.get("multiple")?";":""))},select:function(b){if("object"==typeof b&&!a.isArray(b)){var c,d,e=!0;if("undefined"!=typeof b.blank&&(e=Boolean(b.blank)),b.id&&(!isNaN(b.id)||a.isArray(b.id)))return void this._selectByID(parseInt(b.id));if(b.value)c=b.value,d="value";else{if(!b.label)return;c=b.label,d="label"}if(a.inArray(typeof c,["number","string"])>-1)c=[c];else if("object"!=typeof c||!a.isArray(c))return null;if(!this.get("multiple")&&c.length>1)return null;for(var f=this.get("list"),g=0,h=f.length;h>g;g++)a.inArray(f[g][d],c)>-1?f[g].selected=!0:e&&(f[g].selected=!1);this.applySelectedToList(),this.applySelectedToInput()}},_selectByID:function(b){var c;if(isNaN(b)){if(!a.isArray(b))return}else b=[parseInt(b)];var d=this.get("list");for(c=0;c<d.length;c++)d[c].selected=!1;for(c=0;c<b.length;c++)isNaN(b[c])||d.hasOwnProperty(b[c])&&(d[b[c]].selected=!0);b.length&&(this.applySelectedToInput(),this.applySelectedToList())},_deselectByID:function(b){var c;if(isNaN(b)){if(!a.isArray(b))return}else b=[parseInt(b)];var d=this.get("list");for(c=0;c<b.length;c++)isNaN(b[c])||d.hasOwnProperty(b[c])&&(d[b[c]].selected=!1);b.length&&(this.applySelectedToInput(),this.applySelectedToList())},_optionFiltersMatcher:function(b,c,d){if(arguments.length<3)return!0;if("function"==typeof b&&(b=[b]),!a.isArray(b))return!1;for(var e=0;e<b.length;e++)if(b[e].apply(this,[c,d]))return!0;return!1},defaultOptionFilters:{"default":function(a,b){if("string"!=typeof a||"string"!=typeof b)return!1;var c=new RegExp(a.toLowerCase().trim());return b=b.toString().toLowerCase(),Boolean(b.match(c))},russianKeyboard:function(a,b){if("string"!=typeof a||"string"!=typeof b)return!1;for(var c={"`":"ё","~":"ё",q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з","[":"х","{":"х","]":"ъ","}":"ъ",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",";":"ж",":":"э","'":"э",'"':"э",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",",":"б","<":"б",".":"ю",">":"ю"},d=a.toLowerCase().split(""),e=0,f=d.length;f>e;e++)c.hasOwnProperty(d[e])&&(d[e]=c[d[e]]);return this.defaultOptionFilters["default"](d.join(""),b)}},_hideItems:function(){},_unhideItems:function(){},deselectAll:function(){for(var a=this.get("list"),b=0,c=a.length;c>b;b++)a[b].selected=!1;this.applySelectedToList(),this.applySelectedToInput()},selectAll:function(){var a=this.get("list");if(!this.get("multiple"))return null;for(var b=0,c=a.length;c>b;b++)a[b].selected=!0;this.applySelectedToList(),this.applySelectedToInput()},isActive:function(){var b=this.get("dbox",null,null);return 0==a(b).hasClass("m-select-d-box_hidden")},reInitList:function(){var b=this.get("dbox",null,null);a("ul",b).detach(),this._initList()},close:function(){var b=this.get("dbox",null,null);a(b).addClass("m-select-d-box_hidden"),this._closeFade()},open:function(){var b=this.get("dbox",null,null);a(b).removeClass("m-select-d-box_hidden"),this.calcPosition(),this._openFade(),this._applyLang(this.get("language",null,null)),this._isMobileState()&&this.get("dbox_input").focus()},_openFade:function(){a(this._globalElems.fade).removeClass("m-select-d-box_hidden")},_closeFade:function(){a(this._globalElems.fade).addClass("m-select-d-box_hidden")},fx:{isTextInput:function(b){if(b instanceof Node==!1)return!1;var c=b.tagName.toLowerCase();if("input"==c){if(b.type&&a.inArray(b.type.toLowerCase(),["text","password","email","url","search","tel"])>-1)return!0}else if("textarea"==c)return!0;return!1},isHDensScreen:function(){return window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)").matches)||window.devicePixelRatio&&window.devicePixelRatio>1.3||!1},isRetinaScreen:function(){return window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx), only screen and (min-resolution: 75.6dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min--moz-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)").matches)||window.devicePixelRatio&&window.devicePixelRatio>=2||!1},msplit:function(a,b){return b=b.replace(new RegExp("["+a.join("")+"]","g"),a[0]),b.split(a[0])},trim:function(b,c,d){if(b=b.split(""),"string"==typeof c)c=c.split("");else if("object"!=typeof c||"undefined"==typeof c.push)return b.join("");if("undefined"==typeof d&&(d="both"),"both"==d)for(;b.length&&(-1!=a.inArray(b[0],c)||-1!=a.inArray(b[b.length-1],c));)-1!=a.inArray(b[b.length-1],c)&&b.pop(),-1!=a.inArray(b[0],c)&&b.shift();if("left"==d)for(;b.length&&-1!=a.inArray(b[0],c);)b.shift();if("right"==d)for(;b.length&&-1!=a.inArray(b[b.length-1],c);)b.pop();return b.join("")},rest:function(a,b){return"object"!=typeof a?[]:"number"!=typeof b?[]:Array.prototype.slice.call(a,b)}}};var c=["open","close","isActive","get","set","select","selectAll","deselectAll","on","trigger","getSelectedLabels","getSelectedValues","getSelectedKeys","getText","setText"];a.fn.extend({mSelectDBox:function(d){if(this.length){for(var e=b.prototype.getInstances(),f=void 0,g=this[0],h=0;h<e.length;h++)if(e[h].get("target")==g){f=e[h];break}if(!arguments.length)return f;if("string"==typeof d){if(a.inArray(d,c)>-1){var i=b.prototype.fx.rest(arguments,1);if("function"==typeof f[d])return f[d].apply(f,i)}}else if("object"==typeof d)return d.target=this[0],new b(d)}}}),a.prototype.mSelectDBox.prototype=b.prototype}(jQuery);